<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="projectMapper">
	<resultMap type="Member" id="memberResultSet">
		<id property="mNo" column="MNO"/>
		<result property="mId" column="MID"/>
		<result property="mPwd" column="MPWD"/>
		<result property="mName" column="MNAME"/>
		<result property="age" column="AGE"/>
		<result property="gender" column="GENDER"/>
		<result property="email" column="EMAIL"/>
		<result property="address" column="ADDRESS"/>
		<result property="phone" column="PHONE"/>
		<result property="exNumber" column="EXNUMBER"/>
		<result property="hireDate" column="HIRE_DATE"/>
		<result property="entDate" column="ENT_DATE"/>
		<result property="mLevel" column="M_LEVEL"/>
		<result property="mStatus" column="M_STATUS"/>
		<result property="deptCode" column="DEPT_CODE"/>
		<result property="jobCode" column="JOB_CODE"/>	
	</resultMap>
	
	<resultMap type="Project" id="projectResultSet">
		<id property="pId" column="PID"/>
		<result property="pTitle" column="PTITLE"/>
		<result property="pContent" column="PCONTENT"/>
		<result property="progress" column="PROGRESS"/>
		<result property="pDate" column="PDATE"/>
		<result property="deadLine" column="DEADLINE"/>
		<result property="pStatus" column="PSTATUS"/>
		<result property="manager" column="MANAGER"/>
	</resultMap>
	
	<resultMap type="Pmember" id="pmemberResultSet">
		<id property="mNo" column="MNO"/>
		<result property="pKinds" column="P_KINDS"/>
		<result property="pmStatus" column="PM_STATUS"/>
		<result property="ptId" column="PT_ID"/>
		<result property="pId" column="PID"/>
	</resultMap>
	
	<select id="selectmyProject" parameterType="Project" resultMap="projectResultSet">
		SELECT P.PID,PTITLE,PCONTENT,PROGRESS,PDATE,DEADLINE,PSTATUS,MANAGER
		FROM PROJECT P, PMEMBER M
		WHERE MNO = #{mNo}
		AND P.PID = M.PID
		ORDER BY PDATE
	</select>
	
	<!-- 프로젝트 임시 생성(결재 등록 시 - 결재 완료 전까지 상태 W 로 내용 저장) -->
	<insert id="inserteaP" parameterType="Project">
		INSERT INTO PROJECT VALUES(
			SEQ_PID.NEXTVAL, #{pTitle} , #{ pContent }, 'W', #{ pDate },
			 #{deadLine}, 'W' , #{ manager } ,SEQ_EAID.CURRVAL
		)
	</insert>
	<!-- 프로젝트 생성(결재 완료 시 - 상태 Y로 정식 프로젝트 진행 ) -->
	<update id="PEAupdateY" parameterType="_int">
		UPDATE PROJECT
		SET PSTATUS='Y', PROGRESS='I'
		WHERE EA_NO = #{ ea_no }
	</update>
	
</mapper>